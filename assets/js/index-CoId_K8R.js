import{p as O}from"./index-mHXP9XuL.js";import{_ as q,j as k}from"./index-wGHZtEHf.js";import{_ as T}from"./icon.vue_vue_type_script_setup_true_lang-DMo2cqec.js";import{d as B,b as P,i as F,o as r,c as i,F as v,ac as x,a as m,$,a0 as b,k as g,Z as U,r as C,j as I,V as N,W as R,_ as E}from"./@vue-pvvZVrFb.js";import"./floating-vue-4fuRf8vs.js";import"./@floating-ui-DiM7Jq06.js";import"./overlayscrollbars-DIcyBJd7.js";import"./vue-m-message-DjrEUVXL.js";import"./element-plus-C-DFkfq5.js";import"./lodash-es-l8Yk8yFo.js";import"./@vueuse-T0N5pcum.js";import"./nprogress-D_ytO6nf.js";import"./@imengyu-CJXSuKKD.js";import"./vue-CFNvRKsS.js";import"./@element-plus-B1SGd3PH.js";import"./@sxzz-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-BU0tXZvT.js";import"./async-validator-CRbnkQr6.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./crypto-js-B0zqdDQ0.js";import"./pinia-DSCqkA4F.js";import"./vue-demi-Dq6ymT-8.js";import"./colord-CrBFWQzZ.js";import"./monaco-editor-Dhhxw_oD.js";import"./vue-router-EGzKxKvl.js";import"./path-browserify-OMgzBbgZ.js";import"./axios-CRnBnh7r.js";import"./@iconify-CaxNw4tt.js";import"./vite-plugin-mock-Bh-DZNsC.js";import"./mockjs-CK6d0B8Y.js";import"./index.vue_vue_type_script_setup_true_lang-6EwJ9N-Y.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const j=[{label:"string",value:"string"},{label:"number",value:"number"},{label:"boolean",value:"boolean"},{label:"method",value:"method"},{label:"regexp",value:"regexp"},{label:"integer",value:"integer"},{label:"float",value:"float"},{label:"array",value:"array"},{label:"object",value:"object"},{label:"date",value:"date"},{label:"url",value:"url"},{label:"hex",value:"hex"},{label:"email",value:"email"},{label:"any",value:"any"}],D=[{label:"change",value:"change"},{label:"blur",value:"blur"}],w=["string","number","url","array","email"],M={class:"rule-item-main hover:border-primary relative m-t-2 border border-gray-200 rounded border-solid bg-white p-2 transition-all"},A={key:0,class:"m-t-2 flex first:m-0"},L={class:"elegant-attr-label",title:"校验时机"},W={class:"elegant-attr-input"},Z=B({__name:"ERuleItem",props:{rule:{}},emits:["change","delete","update:rule"],setup(y,{emit:f}){const c=y,p=f,o=P({get(){return c.rule},set(e){p("update:rule",e)}}),a=F("pageManager",{}),_=P(()=>Object.entries(a.funcs.value).filter(([e,n])=>typeof n=="function").map(([e])=>({label:e,value:e}))),t=[{type:"select",label:"校验时机",model:"trigger",componentProps:{options:D,placeholder:"校验时机",multiple:!0,mode:"multiple"}},{type:"switch",label:"自定义规则",model:"isValidator"},{type:"select",label:"校验函数",model:"validator",show(){return!!o.value.isValidator},componentProps:{options:_.value,placeholder:"校验函数"}},{type:"select",label:"类型",model:"type",show(){return!o.value.isValidator},componentProps:{options:j,placeholder:"类型"}},{type:"input",label:"正则校验",model:"pattern",show(){return!o.value.isValidator},componentProps:{placeholder:"正则校验"}},{type:"number",label:"字段长度",model:"len",show(){return w.includes(o.value.type??"")},componentProps:{min:0,placeholder:"字段长度"}},{type:"number",label:"最小长度",model:"min",show(){return w.includes(o.value.type??"")},componentProps:{min:0,placeholder:"最小长度"}},{type:"number",label:"最大长度",model:"max",show(){return w.includes(o.value.type??"")},componentProps:{min:0,placeholder:"最大长度"}},{type:"input",label:"校验信息",model:"message",componentProps:{placeholder:"校验信息"}}];function V(){const e=o.value;e.isValidator?(delete e.type,delete e.pattern,delete e.len,delete e.min,delete e.max):delete e.validator,p("change",e)}function d(){p("delete")}return(e,n)=>(r(),i("div",M,[(r(),i(v,null,x(t,(l,u)=>(r(),i(v,{key:u},[!l.show||l.show()?(r(),i("div",A,[m("div",L,$(l.label),1),m("div",W,[b(g(q),{modelValue:o.value[l.model],"onUpdate:modelValue":s=>o.value[l.model]=s,"component-schema":{...l,noFormItem:!0},onChange:V},null,8,["modelValue","onUpdate:modelValue","component-schema"])])])):U("",!0)],64))),64)),m("div",{class:"rule-btn-delete text-md absolute right-0 top-0 h-24px w-24px flex cursor-pointer items-center justify-center rounded-bl-2 color-white transition-all",onClick:d},[b(g(T),{name:"icon--elegant--delete-outline-rounded"})])]))}}),z={class:"rule-item-main relative m-t-2 border rounded border-solid p-2 transition-all"},G={key:0,class:"m-t-2 flex first:m-0"},H={class:"elegant-attr-label"},J={class:"flex-1"},$e=B({__name:"index",props:{ruleType:{type:String,default:"string"},modelValue:{type:Array,default:void 0}},emits:["update:modelValue"],setup(y,{emit:f}){const c=y,p=f,o=O.getComponent("button"),a=C({required:!1,message:"必填项",type:c.ruleType,trigger:["change"]}),_=[{type:"switch",label:"必填项",model:"required"},{type:"select",label:"校验时机",model:"trigger",show(){return!!a.value.required},componentProps:{options:D,placeholder:"校验时机",multiple:!0,mode:"multiple"}},{type:"select",label:"类型",model:"type",show(){return!!a.value.required},componentProps:{options:j,placeholder:"类型"}},{type:"input",label:"校验信息",model:"message",show(){return!!a.value.required},componentProps:{placeholder:"校验信息"}}],t=C([]);I(()=>c.modelValue,n=>{if(n){if(!n)return;t.value=[],n.forEach(l=>{typeof l.required<"u"?a.value=l:t.value.push(l)})}},{immediate:!0});function V(){t.value.push({message:"",type:c.ruleType,trigger:["change"]}),d()}function d(){if(a.value.required){p("update:modelValue",k([...t.value,a.value]));return}if(t.value.length){p("update:modelValue",k(t.value));return}p("update:modelValue",void 0)}function e(n){t.value.splice(n,1),d()}return(n,l)=>(r(),i("div",null,[m("div",z,[(r(),i(v,null,x(_,(u,s)=>(r(),i(v,{key:s},[!u.show||u.show()?(r(),i("div",G,[m("div",H,$(u.label),1),m("div",J,[b(g(q),{modelValue:a.value[u.model],"onUpdate:modelValue":h=>a.value[u.model]=h,"component-schema":{...u,noFormItem:!0},onChange:d},null,8,["modelValue","onUpdate:modelValue","component-schema"])])])):U("",!0)],64))),64))]),(r(!0),i(v,null,x(t.value,(u,s)=>(r(),N(Z,{key:s,rule:t.value[s],"onUpdate:rule":h=>t.value[s]=h,onDelete:h=>e(s),onChange:d},null,8,["rule","onUpdate:rule","onDelete"]))),128)),b(g(o),{class:"m-t-2",onClick:V},{default:R(()=>l[0]||(l[0]=[E(" 添加规则 ")])),_:1})]))}});export{$e as default};
